# Руководство по внесению вклада

## Введение

Спасибо за рассмотрение возможности внести вклад в проект filesql! Этот документ объясняет, как внести вклад в проект. Мы приветствуем все формы вклада, включая вклад в код, улучшение документации, сообщения об ошибках и предложения функций.

## Настройка среды разработки

### Предварительные требования

#### Установка Go

Для разработки filesql требуется Go 1.24 или более поздняя версия.

**macOS (с использованием Homebrew)**
```bash
brew install go
```

**Linux (для Ubuntu)**
```bash
# Используя snap
sudo snap install go --classic

# Или скачать с официального сайта
wget https://go.dev/dl/go1.24.0.linux-amd64.tar.gz
sudo tar -C /usr/local -xzf go1.24.0.linux-amd64.tar.gz
echo 'export PATH=$PATH:/usr/local/go/bin' >> ~/.profile
source ~/.profile
```

**Windows**
Скачайте и запустите установщик с [официального сайта Go](https://go.dev/dl/).

Проверка установки:
```bash
go version
```

### Клонирование проекта

```bash
git clone https://github.com/nao1215/filesql.git
cd filesql
```

### Установка инструментов разработки

```bash
# Установить необходимые инструменты разработки
make tools
```

### Проверка

Чтобы убедиться, что ваша среда разработки настроена правильно, выполните следующие команды:

```bash
# Запуск тестов
make test

# Запуск линтера
make lint
```

## Структура проекта

```
filesql/
├── domain/          # Слой доменной модели
│   ├── model/      # Определения доменной модели
│   └── repository/ # Интерфейсы репозитория
├── testdata/       # Файлы тестовых данных
├── doc/            # Документация
│   ├── ja/        # Японская документация
│   ├── zh-cn/     # Китайская документация
│   ├── es/        # Испанская документация
│   └── ...        # Другие языки
├── filesql.go      # Главная точка входа библиотеки
├── filesql_test.go # Тесты библиотеки
└── example_test.go # Примеры использования
```

### Роли директорий

- **domain/**: Слой, содержащий бизнес-логику и доменные модели. Чистая реализация Go без внешних зависимостей
- **testdata/**: Примеры файлов, таких как CSV, TSV, LTSV, используемых в тестах
- **doc/**: Многоязычная документация с поддиректориями для каждого языка

## Рабочий процесс разработки

### Стратегия веток

- Ветка `main` - это последняя стабильная версия
- Создавайте новые ветки от `main` для новых функций или исправления ошибок
- Примеры названий веток:
  - `feature/add-json-support` - Новая функция
  - `fix/issue-123` - Исправление ошибки
  - `docs/update-readme` - Обновление документации

### Стандарты кодирования

Этот проект следует этим стандартам:

1. **Соответствие [Effective Go](https://go.dev/doc/effective_go)**
2. **Избегайте использования глобальных переменных** (кроме пакета config)
3. **Всегда добавляйте комментарии к публичным функциям, переменным и структурам**
4. **Держите функции максимально маленькими**
5. **Написание тестов приветствуется**

### Написание тестов

Тесты важны. Пожалуйста, следуйте этим рекомендациям:

1. **Модульные тесты**: Стремитесь к покрытию 80% или выше
2. **Читаемость тестов**: Пишите четкие тестовые случаи
3. **Параллельное выполнение**: Используйте `t.Parallel()` везде, где это возможно

Пример теста:
```go
func TestFile_Parse(t *testing.T) {
    t.Parallel()
    
    t.Run("should parse CSV file correctly", func(t *testing.T) {
        // Четкие входные данные и ожидаемые значения для тестового случая
        input := "name,age\nAlice,30"
        expected := &Table{...}
        
        result, err := ParseCSV(input)
        assert.NoError(t, err)
        assert.Equal(t, expected, result)
    })
}
```

## Создание Pull Request

### Подготовка

1. **Проверка или создание Issue**
   - Проверьте, существуют ли уже Issues
   - Для крупных изменений рекомендуем сначала обсудить подход в Issue

2. **Написание тестов**
   - Всегда добавляйте тесты для новых функций
   - Для исправления ошибок создайте тесты, которые воспроизводят ошибку

3. **Проверка качества**
   ```bash
   # Убедитесь, что все тесты проходят
   make test
   
   # Проверка линтера
   make lint
   
   # Проверка покрытия (80% или выше)
   go test -cover ./...
   ```

### Отправка Pull Request

1. Создайте Pull Request из вашего форкнутого репозитория в основной репозиторий
2. Заголовок PR должен кратко описывать изменения
3. Включите в описание PR следующее:
   - Цель и содержание изменений
   - Номер связанной issue (если есть)
   - Метод тестирования
   - Шаги воспроизведения для исправления ошибок

### О CI/CD

GitHub Actions автоматически проверяет следующие элементы:

- **Кроссплатформенное тестирование**: Выполнение тестов на Linux, macOS и Windows
- **Проверка линтера**: Статический анализ с golangci-lint
- **Покрытие тестами**: Поддержание покрытия 80% или выше
- **Проверка сборки**: Успешная сборка на каждой платформе

Слияние невозможно, пока не пройдут все проверки.

## Сообщения об ошибках

Когда вы обнаружите ошибку, пожалуйста, создайте issue со следующей информацией:

1. **Информация о среде**
   - ОС (Linux/macOS/Windows) и версия
   - Версия Go
   - Версия filesql

2. **Шаги воспроизведения**
   - Минимальный пример кода для воспроизведения ошибки
   - Используемые файлы данных (если возможно)

3. **Ожидаемое и фактическое поведение**

4. **Сообщения об ошибках или трассировка стека** (если есть)

## Вклад вне кода

Следующие виды деятельности также очень приветствуются:

### Действия, повышающие мотивацию

- **Поставить звезду на GitHub**: Покажите свой интерес к проекту
- **Продвижение проекта**: Представьте его в блогах, социальных сетях, учебных группах и т.д.
- **Стать спонсором GitHub**: Поддержка доступна на [https://github.com/sponsors/nao1215](https://github.com/sponsors/nao1215)

### Другие способы внести вклад

- **Улучшение документации**: Исправление опечаток, улучшение ясности объяснений
- **Переводы**: Перевод документации на новые языки
- **Добавление примеров**: Предоставление практического примера кода
- **Предложения функций**: Поделитесь идеями новых функций в issues

## Сообщество

### Кодекс поведения

Пожалуйста, обратитесь к [CODE_OF_CONDUCT.md](../../CODE_OF_CONDUCT.md). Мы ожидаем, что все участники будут относиться друг к другу с уважением.

### Вопросы и отчеты

- **GitHub Issues**: Сообщения об ошибках и предложения функций

## Лицензия

Вклад в этот проект считается опубликованным под лицензией проекта (лицензия MIT).

---

Еще раз спасибо за рассмотрение возможности внести вклад! Мы искренне ждем вашего участия.