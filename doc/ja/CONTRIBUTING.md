# 貢献ガイド

## はじめに

filesqlプロジェクトへの貢献を検討していただき、ありがとうございます！このドキュメントでは、プロジェクトへの貢献方法について説明します。コードの貢献はもちろん、ドキュメントの改善、バグ報告、機能提案など、あらゆる形での貢献を歓迎します。

## 開発環境のセットアップ

### 前提条件

#### Go言語のインストール

filesqlの開発にはGo 1.24以降が必要です。

**macOS (Homebrew使用)**
```bash
brew install go
```

**Linux (Ubuntuの場合)**
```bash
# snapを使用
sudo snap install go --classic

# または公式サイトからダウンロード
wget https://go.dev/dl/go1.24.0.linux-amd64.tar.gz
sudo tar -C /usr/local -xzf go1.24.0.linux-amd64.tar.gz
echo 'export PATH=$PATH:/usr/local/go/bin' >> ~/.profile
source ~/.profile
```

**Windows**
[Go公式サイト](https://go.dev/dl/)からインストーラーをダウンロードして実行してください。

インストール確認：
```bash
go version
```

### プロジェクトのクローン

```bash
git clone https://github.com/nao1215/filesql.git
cd filesql
```

### 開発ツールのインストール

```bash
# 開発に必要なツールをインストール
make tools
```

### 動作確認

開発環境が正しくセットアップされているか確認するため、以下のコマンドを実行してください：

```bash
# テストの実行
make test

# リンターの実行
make lint
```

## 開発ワークフロー

### ブランチ戦略

- `main`ブランチが最新の安定版です
- 新機能やバグ修正は、`main`から新しいブランチを作成してください
- ブランチ名の例：
  - `feature/add-json-support` - 新機能追加
  - `fix/issue-123` - バグ修正
  - `docs/update-readme` - ドキュメント更新

### コーディング規約

このプロジェクトでは以下の規約に従います：

1. **[Effective Go](https://go.dev/doc/effective_go)**に準拠
2. **グローバル変数の使用は避ける**（configパッケージを除く）
3. **パブリックな関数、変数、構造体には必ずコメント**を記述
4. **関数はできるだけ小さく保つ**
5. **テストを書く**ことを推奨

### テストの作成

テストは重要です。以下のガイドラインに従ってください：

1. **単体テスト**: カバレッジ80%以上を目標
2. **テストの可読性**: 各テストケースが明確になるように記述
3. **並列実行**: 可能な限り`t.Parallel()`を使用

テストの例：
```go
func TestFile_Parse(t *testing.T) {
    t.Parallel()
    
    t.Run("should parse CSV file correctly", func(t *testing.T) {
        // テストケースの入力と期待値を明確に
        input := "name,age\nAlice,30"
        expected := &Table{...}
        
        result, err := ParseCSV(input)
        assert.NoError(t, err)
        assert.Equal(t, expected, result)
    })
}
```

## AIアシスタント（LLM）の活用

私たちは生産性と品質向上のため、AIコーディングアシスタントの利用を積極的に推奨しています。Claude Code、GitHub Copilot、Cursorなどのツールは以下の用途で活用できます：

- ボイラープレートコードの生成
- 包括的なテストケースの生成
- ドキュメントの改善
- 既存コードのリファクタリング
- 潜在的なバグの発見
- パフォーマンス最適化の提案
- ドキュメントの翻訳

### AI支援開発のガイドライン

1. **生成コードのレビュー**: AI生成コードは必ずレビューし、理解してからコミットしてください
2. **一貫性の維持**: AI生成コードがCLAUDE.mdのコーディング標準に従っていることを確認してください
3. **徹底的なテスト**: AI生成コードは全てのテストとリンティング（`make test`と`make lint`）に合格する必要があります
4. **プロジェクト設定の利用**: `CLAUDE.md`、`.cursorrules`と`.github/copilot-instructions.md`を用意しており、AIアシスタントがプロジェクト標準を理解できるようになっています

## Pull Requestの作成

### 事前準備

1. **Issueの確認または作成**
   - 既存のIssueがないか確認してください
   - 大きな変更の場合は、事前にIssueで方針を議論することを推奨します

2. **テストの作成**
   - 新機能にはテストを必ず追加してください
   - バグ修正の場合は、バグを再現するテストを作成してください
   - AIツールを使って包括的なテストケースを生成できます

3. **品質チェック**
   ```bash
   # テストが全て通ることを確認
   make test
   
   # リンターチェック
   make lint
   
   # カバレッジの確認（80%以上）
   go test -cover ./...
   ```

### Pull Requestの提出

1. フォークしたリポジトリから本家リポジトリへPull Requestを作成
2. PRのタイトルは変更内容を簡潔に説明
3. PRの説明に以下を含める：
   - 変更の目的と内容
   - 関連するIssue番号（あれば）
   - テスト方法
   - バグ修正の場合は再現手順

### CI/CDについて

GitHub Actionsで以下の項目が自動的にチェックされます：

- **クロスプラットフォームテスト**: Linux、macOS、Windowsでのテスト実行
- **リンターチェック**: golangci-lintによる静的解析
- **テストカバレッジ**: 80%以上のカバレッジを維持
- **ビルド確認**: 各プラットフォームでのビルド成功

全てのチェックが通過しない限り、マージはできません。

## バグ報告

バグを発見した場合は、以下の情報を含めてIssueを作成してください：

1. **環境情報**
   - OS（Linux/macOS/Windows）とバージョン
   - Goのバージョン
   - filesqlのバージョン

2. **再現手順**
   - バグを再現するための最小限のコード例
   - 使用したデータファイル（可能であれば）

3. **期待する動作と実際の動作**

4. **エラーメッセージやスタックトレース**（あれば）

## コーディング以外での貢献

以下の活動も大いに歓迎します：

### モチベーション向上につながる活動

- **GitHub Starを付ける**: プロジェクトへの関心を示してください
- **プロジェクトの宣伝**: ブログ、SNS、勉強会などでの紹介
- **GitHub Sponsorになる**: [https://github.com/sponsors/nao1215](https://github.com/sponsors/nao1215)から支援可能です

### その他の貢献方法

- **ドキュメントの改善**: 誤字脱字の修正、より分かりやすい説明への改善
- **翻訳**: 新しい言語へのドキュメント翻訳
- **使用例の追加**: 実用的なサンプルコードの提供
- **機能提案**: 新機能のアイデアをIssueで共有

## コミュニティ

### 行動規範

[CODE_OF_CONDUCT.md](../../CODE_OF_CONDUCT.md)を参照してください。全ての貢献者に対して敬意を持って接することを期待します。

### 質問や報告

- **GitHub Issues**: バグ報告や機能提案

## ライセンス

このプロジェクトへの貢献は、プロジェクトのライセンス（MITライセンス）の下で公開されることに同意したものとみなされます。

---

貢献を検討していただき、改めてありがとうございます！あなたの参加を心よりお待ちしています。